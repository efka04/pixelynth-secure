[debug] [2025-03-22T04:44:12.552Z] ----------------------------------------------------------------------
[debug] [2025-03-22T04:44:12.553Z] Command:       /Users/florent/.nvm/versions/node/v18.20.7/bin/node /Users/florent/.nvm/versions/node/v18.20.7/bin/firebase deploy --only functions:compressImage --debug
[debug] [2025-03-22T04:44:12.554Z] CLI Version:   13.34.0
[debug] [2025-03-22T04:44:12.554Z] Platform:      darwin
[debug] [2025-03-22T04:44:12.554Z] Node Version:  v18.20.7
[debug] [2025-03-22T04:44:12.555Z] Time:          Sat Mar 22 2025 13:44:12 GMT+0900 (Japan Standard Time)
[debug] [2025-03-22T04:44:12.555Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-03-22T04:44:12.680Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:12.681Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:12.682Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/undefined/serviceAccounts/undefined@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2025-03-22T04:44:12.682Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/undefined/serviceAccounts/undefined@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2025-03-22T04:44:13.758Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/undefined/serviceAccounts/undefined@appspot.gserviceaccount.com:testIamPermissions 404
[debug] [2025-03-22T04:44:13.759Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/undefined/serviceAccounts/undefined@appspot.gserviceaccount.com:testIamPermissions {"error":{"code":404,"message":"Unknown service account","status":"NOT_FOUND"}}
[debug] [2025-03-22T04:44:13.760Z] [functions] service account IAM check errored, deploy may fail: Request to https://iam.googleapis.com/v1/projects/undefined/serviceAccounts/undefined@appspot.gserviceaccount.com:testIamPermissions had HTTP Error: 404, Unknown service account {"name":"FirebaseError","children":[],"context":{"body":{"error":{"code":404,"message":"Unknown service account","status":"NOT_FOUND"}},"response":{"statusCode":404}},"exit":1,"message":"Request to https://iam.googleapis.com/v1/projects/undefined/serviceAccounts/undefined@appspot.gserviceaccount.com:testIamPermissions had HTTP Error: 404, Unknown service account","status":404}
[error] 
[error] Error: No currently active project.
To run this command, you need to specify a project. You have two options:
- Run this command with --project <alias_or_project_id>.
- Set an active project by running firebase use --add, then rerun this command.
To list all the Firebase projects to which you have access, run firebase projects:list.
To learn about active projects for the CLI, visit https://firebase.google.com/docs/cli#project_aliases


[debug] [2025-03-22T04:44:50.898Z] ----------------------------------------------------------------------
[debug] [2025-03-22T04:44:50.899Z] Command:       /Users/florent/.nvm/versions/node/v18.20.7/bin/node /Users/florent/.nvm/versions/node/v18.20.7/bin/firebase deploy --only functions:compressImage --debug --project pixelynth-c41ea
[debug] [2025-03-22T04:44:50.900Z] CLI Version:   13.34.0
[debug] [2025-03-22T04:44:50.900Z] Platform:      darwin
[debug] [2025-03-22T04:44:50.900Z] Node Version:  v18.20.7
[debug] [2025-03-22T04:44:50.901Z] Time:          Sat Mar 22 2025 13:44:50 GMT+0900 (Japan Standard Time)
[debug] [2025-03-22T04:44:50.901Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-03-22T04:44:51.027Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-03-22T04:44:51.028Z] > authorizing via signed-in user (florent.kowalczuk@gmail.com)
[debug] [2025-03-22T04:44:51.028Z] [iam] checking project pixelynth-c41ea for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]
[debug] [2025-03-22T04:44:51.029Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:51.029Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:51.030Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/pixelynth-c41ea:testIamPermissions [none]
[debug] [2025-03-22T04:44:51.030Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/pixelynth-c41ea:testIamPermissions x-goog-quota-user=projects/pixelynth-c41ea
[debug] [2025-03-22T04:44:51.030Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/pixelynth-c41ea:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-03-22T04:44:52.272Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/pixelynth-c41ea:testIamPermissions 200
[debug] [2025-03-22T04:44:52.273Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/pixelynth-c41ea:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-03-22T04:44:52.273Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:52.273Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:52.274Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/pixelynth-c41ea/serviceAccounts/pixelynth-c41ea@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2025-03-22T04:44:52.274Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/pixelynth-c41ea/serviceAccounts/pixelynth-c41ea@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2025-03-22T04:44:53.459Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/pixelynth-c41ea/serviceAccounts/pixelynth-c41ea@appspot.gserviceaccount.com:testIamPermissions 200
[debug] [2025-03-22T04:44:53.459Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/pixelynth-c41ea/serviceAccounts/pixelynth-c41ea@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[info] 
[info] === Deploying to 'pixelynth-c41ea'...
[info] 
[info] i  deploying functions 
[info] Running command: npm --prefix "$RESOURCE_DIR" run lint
[info] ✔  functions: Finished running predeploy script. 
[debug] [2025-03-22T04:44:53.821Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:53.822Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:53.822Z] >>> [apiv2][query] GET https://cloudresourcemanager.googleapis.com/v1/projects/pixelynth-c41ea [none]
[debug] [2025-03-22T04:44:54.614Z] <<< [apiv2][status] GET https://cloudresourcemanager.googleapis.com/v1/projects/pixelynth-c41ea 200
[debug] [2025-03-22T04:44:54.614Z] <<< [apiv2][body] GET https://cloudresourcemanager.googleapis.com/v1/projects/pixelynth-c41ea {"projectNumber":"706633323779","projectId":"pixelynth-c41ea","lifecycleState":"ACTIVE","name":"Pixelynth","labels":{"firebase":"enabled","firebase-core":"disabled"},"createTime":"2024-12-26T06:00:30.998931Z"}
[info] i  functions: preparing codebase default for deployment 
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[debug] [2025-03-22T04:44:54.616Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:54.616Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:54.616Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:54.616Z] Checked if tokens are valid: true, expires at: 1742619613169
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[debug] [2025-03-22T04:44:54.617Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:54.617Z] Checked if tokens are valid: true, expires at: 1742619613169
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2025-03-22T04:44:54.617Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:54.617Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:54.617Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/pixelynth-c41ea/services/cloudfunctions.googleapis.com [none]
[debug] [2025-03-22T04:44:54.617Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/pixelynth-c41ea/services/cloudfunctions.googleapis.com x-goog-quota-user=projects/pixelynth-c41ea
[debug] [2025-03-22T04:44:54.619Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/pixelynth-c41ea/services/runtimeconfig.googleapis.com [none]
[debug] [2025-03-22T04:44:54.619Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/pixelynth-c41ea/services/runtimeconfig.googleapis.com x-goog-quota-user=projects/pixelynth-c41ea
[debug] [2025-03-22T04:44:54.621Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/pixelynth-c41ea/services/cloudbuild.googleapis.com [none]
[debug] [2025-03-22T04:44:54.621Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/pixelynth-c41ea/services/cloudbuild.googleapis.com x-goog-quota-user=projects/pixelynth-c41ea
[debug] [2025-03-22T04:44:54.622Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/pixelynth-c41ea/services/artifactregistry.googleapis.com [none]
[debug] [2025-03-22T04:44:54.622Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/pixelynth-c41ea/services/artifactregistry.googleapis.com x-goog-quota-user=projects/pixelynth-c41ea
[debug] [2025-03-22T04:44:55.090Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/pixelynth-c41ea/services/cloudfunctions.googleapis.com 200
[debug] [2025-03-22T04:44:55.090Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/pixelynth-c41ea/services/cloudfunctions.googleapis.com [omitted]
[info] ✔  functions: required API cloudfunctions.googleapis.com is enabled 
[debug] [2025-03-22T04:44:55.738Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/pixelynth-c41ea/services/artifactregistry.googleapis.com 200
[debug] [2025-03-22T04:44:55.739Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/pixelynth-c41ea/services/artifactregistry.googleapis.com [omitted]
[info] ✔  artifactregistry: required API artifactregistry.googleapis.com is enabled 
[debug] [2025-03-22T04:44:55.739Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/pixelynth-c41ea/services/runtimeconfig.googleapis.com 200
[debug] [2025-03-22T04:44:55.739Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/pixelynth-c41ea/services/runtimeconfig.googleapis.com [omitted]
[debug] [2025-03-22T04:44:55.740Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/pixelynth-c41ea/services/cloudbuild.googleapis.com 200
[debug] [2025-03-22T04:44:55.741Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/pixelynth-c41ea/services/cloudbuild.googleapis.com [omitted]
[info] ✔  functions: required API cloudbuild.googleapis.com is enabled 
[debug] [2025-03-22T04:44:55.741Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:55.741Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:55.741Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/pixelynth-c41ea/adminSdkConfig [none]
[debug] [2025-03-22T04:44:56.662Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/pixelynth-c41ea/adminSdkConfig 200
[debug] [2025-03-22T04:44:56.662Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/pixelynth-c41ea/adminSdkConfig {"projectId":"pixelynth-c41ea","storageBucket":"pixelynth-c41ea.firebasestorage.app"}
[debug] [2025-03-22T04:44:56.663Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:56.663Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:56.663Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/pixelynth-c41ea/configs [none]
[debug] [2025-03-22T04:44:57.127Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/pixelynth-c41ea/configs 200
[debug] [2025-03-22T04:44:57.128Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/pixelynth-c41ea/configs {}
[debug] [2025-03-22T04:44:57.129Z] Validating nodejs source
[warn] ⚠  functions: Runtime Node.js 18 will be deprecated on 2025-04-30 and will be decommissioned on 2025-10-31, after which you will not be able to deploy without upgrading. Consider upgrading now to avoid disruption. See https://cloud.google.com/functions/docs/runtime-support for full details on the lifecycle policy 
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[warn] ⚠  functions: Please note that there will be breaking changes when you upgrade. 
[debug] [2025-03-22T04:44:57.793Z] > [functions] package.json contents: {
  "name": "functions",
  "description": "Cloud Functions for Firebase",
  "scripts": {
    "lint": "echo 'Lint check skipped' && exit 0",
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log",
    "test": "mocha --reporter spec --timeout 10000 test/*.test.js"
  },
  "engines": {
    "node": "18"
  },
  "main": "index.js",
  "dependencies": {
    "firebase-admin": "^11.8.0",
    "firebase-functions": "^4.3.1",
    "fs": "^0.0.1-security",
    "os": "^0.1.2",
    "path": "^0.12.7",
    "sharp": "^0.33.5"
  },
  "devDependencies": {
    "chai": "^5.2.0",
    "eslint": "^8.15.0",
    "eslint-config-google": "^0.14.0",
    "firebase-functions-test": "^3.1.0",
    "mocha": "^11.1.0",
    "sinon": "^19.0.4"
  },
  "private": true
}
[debug] [2025-03-22T04:44:57.794Z] Building nodejs source
[info] i  functions: Loading and analyzing source code for codebase default to determine what to deploy 
[info] i  functions: You are using a version of firebase-functions SDK (4.9.0) that does not have support for the newest Firebase Extensions features. Please update firebase-functions SDK to >=5.1.0 to use them correctly 
[debug] [2025-03-22T04:44:57.794Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-03-22T04:44:57.801Z] Found firebase-functions binary at '/Users/florent/pixelynth-secure/functions/node_modules/.bin/firebase-functions'
[info] Serving at port 8714

[debug] [2025-03-22T04:44:58.120Z] Got response from /__/functions.yaml {"endpoints":{"syncPostToMyImages":{"platform":"gcfv1","availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"serviceAccountEmail":null,"vpc":null,"eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.update","eventFilters":{"resource":"projects/pixelynth-c41ea/databases/(default)/documents/post/{postId}"},"retry":false},"labels":{},"entryPoint":"syncPostToMyImages"},"syncDeletePostToMyImages":{"platform":"gcfv1","availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"serviceAccountEmail":null,"vpc":null,"eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.delete","eventFilters":{"resource":"projects/pixelynth-c41ea/databases/(default)/documents/post/{postId}"},"retry":false},"labels":{},"entryPoint":"syncDeletePostToMyImages"},"syncDeleteMyImagesToPost":{"platform":"gcfv1","availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"serviceAccountEmail":null,"vpc":null,"eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.delete","eventFilters":{"resource":"projects/pixelynth-c41ea/databases/(default)/documents/users/{userEmail}/MyImages/{imageId}"},"retry":false},"labels":{},"entryPoint":"syncDeleteMyImagesToPost"}},"specVersion":"v1alpha1","requiredAPIs":[]}
[info] i  functions: preparing functions directory for uploading... 
[info] i  functions: packaged /Users/florent/pixelynth-secure/functions (97.13 KB) for uploading 
[debug] [2025-03-22T04:44:58.176Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:58.176Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:58.176Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/projects/pixelynth-c41ea/locations/-/functions [none]
[debug] [2025-03-22T04:44:59.124Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/projects/pixelynth-c41ea/locations/-/functions 200
[debug] [2025-03-22T04:44:59.125Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/projects/pixelynth-c41ea/locations/-/functions {"functions":[{"name":"projects/pixelynth-c41ea/locations/us-central1/functions/serveImage","httpsTrigger":{"url":"https://us-central1-pixelynth-c41ea.cloudfunctions.net/serveImage","securityLevel":"SECURE_ALWAYS"},"status":"ACTIVE","entryPoint":"serveImage","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"pixelynth-c41ea@appspot.gserviceaccount.com","updateTime":"2025-02-16T16:07:45.355Z","versionId":"2","labels":{"deployment-tool":"cli-firebase","firebase-functions-hash":"b0663e02234700c161b50e1e4c0a7ba52b066bd7"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-378379930562.us-central1.cloudfunctions.appspot.com/ba1d56e9-b7af-4353-a161-f2d1c362d7fb.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"pixelynth-c41ea\",\"storageBucket\":\"pixelynth-c41ea.firebasestorage.app\"}","GCLOUD_PROJECT":"pixelynth-c41ea","EVENTARC_CLOUD_EVENT_SOURCE":"projects/pixelynth-c41ea/locations/us-central1/functions/serveImage"},"runtime":"nodejs18","ingressSettings":"ALLOW_ALL","buildId":"769d3c15-96ee-400b-86df-be993a777457","buildEnvironmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"buildName":"projects/706633323779/locations/us-central1/builds/769d3c15-96ee-400b-86df-be993a777457","dockerRegistry":"ARTIFACT_REGISTRY","automaticUpdatePolicy":{},"buildServiceAccount":"projects/pixelynth-c41ea/serviceAccounts/706633323779-compute@developer.gserviceaccount.com"},{"name":"projects/pixelynth-c41ea/locations/us-central1/functions/syncDeleteMyImagesToPost","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.delete","resource":"projects/pixelynth-c41ea/databases/(default)/documents/users/{userEmail}/MyImages/{imageId}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"syncDeleteMyImagesToPost","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"pixelynth-c41ea@appspot.gserviceaccount.com","updateTime":"2025-03-22T04:37:32.779Z","versionId":"4","labels":{"deployment-tool":"cli-firebase","firebase-functions-hash":"dbe9587dbd4de36d4c8ecf2fd7b5eef9e1dfb2cd"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-378379930562.us-central1.cloudfunctions.appspot.com/9f488130-e9bb-4bc1-b6ac-f7f93a2b68c6.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"pixelynth-c41ea\",\"storageBucket\":\"pixelynth-c41ea.firebasestorage.app\"}","GCLOUD_PROJECT":"pixelynth-c41ea","EVENTARC_CLOUD_EVENT_SOURCE":"projects/pixelynth-c41ea/locations/us-central1/functions/syncDeleteMyImagesToPost"},"runtime":"nodejs18","maxInstances":3000,"ingressSettings":"ALLOW_ALL","buildId":"d6fe116b-02ab-402d-865d-a467c9e32b7c","buildEnvironmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"buildName":"projects/706633323779/locations/us-central1/builds/d6fe116b-02ab-402d-865d-a467c9e32b7c","dockerRegistry":"ARTIFACT_REGISTRY","automaticUpdatePolicy":{},"buildServiceAccount":"projects/pixelynth-c41ea/serviceAccounts/706633323779-compute@developer.gserviceaccount.com"},{"name":"projects/pixelynth-c41ea/locations/us-central1/functions/syncImageDelete","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.delete","resource":"projects/pixelynth-c41ea/databases/(default)/documents/post/{imageId}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"syncImageDelete","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"pixelynth-c41ea@appspot.gserviceaccount.com","updateTime":"2025-03-20T05:22:38.600564104Z","versionId":"1","labels":{"firebase-functions-hash":"749913253e557e55cf60042929f0fa46828a9dcc","deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-378379930562.us-central1.cloudfunctions.appspot.com/efad332c-b59e-4f2e-9a19-7e30407a42d7.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"pixelynth-c41ea\",\"storageBucket\":\"pixelynth-c41ea.firebasestorage.app\"}","GCLOUD_PROJECT":"pixelynth-c41ea","EVENTARC_CLOUD_EVENT_SOURCE":"projects/pixelynth-c41ea/locations/us-central1/functions/syncImageDelete"},"runtime":"nodejs18","maxInstances":3000,"ingressSettings":"ALLOW_ALL","buildId":"5e473b78-fc35-42c1-84c9-70285c9c8574","buildEnvironmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"buildName":"projects/706633323779/locations/us-central1/builds/5e473b78-fc35-42c1-84c9-70285c9c8574","dockerRegistry":"ARTIFACT_REGISTRY","automaticUpdatePolicy":{},"buildServiceAccount":"projects/pixelynth-c41ea/serviceAccounts/706633323779-compute@developer.gserviceaccount.com"},{"name":"projects/pixelynth-c41ea/locations/us-central1/functions/syncPostToMyImages","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.update","resource":"projects/pixelynth-c41ea/databases/(default)/documents/post/{postId}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"syncPostToMyImages","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"pixelynth-c41ea@appspot.gserviceaccount.com","updateTime":"2025-03-22T04:37:32.995Z","versionId":"4","labels":{"deployment-tool":"cli-firebase","firebase-functions-hash":"dbe9587dbd4de36d4c8ecf2fd7b5eef9e1dfb2cd"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-378379930562.us-central1.cloudfunctions.appspot.com/9f488130-e9bb-4bc1-b6ac-f7f93a2b68c6.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"pixelynth-c41ea\",\"storageBucket\":\"pixelynth-c41ea.firebasestorage.app\"}","GCLOUD_PROJECT":"pixelynth-c41ea","EVENTARC_CLOUD_EVENT_SOURCE":"projects/pixelynth-c41ea/locations/us-central1/functions/syncPostToMyImages"},"runtime":"nodejs18","maxInstances":3000,"ingressSettings":"ALLOW_ALL","buildId":"d6fe116b-02ab-402d-865d-a467c9e32b7c","buildEnvironmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"buildName":"projects/706633323779/locations/us-central1/builds/d6fe116b-02ab-402d-865d-a467c9e32b7c","dockerRegistry":"ARTIFACT_REGISTRY","automaticUpdatePolicy":{},"buildServiceAccount":"projects/pixelynth-c41ea/serviceAccounts/706633323779-compute@developer.gserviceaccount.com"},{"name":"projects/pixelynth-c41ea/locations/us-central1/functions/syncDeletePostToMyImages","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.delete","resource":"projects/pixelynth-c41ea/databases/(default)/documents/post/{postId}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"syncDeletePostToMyImages","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"pixelynth-c41ea@appspot.gserviceaccount.com","updateTime":"2025-03-22T04:37:32.919Z","versionId":"4","labels":{"deployment-tool":"cli-firebase","firebase-functions-hash":"dbe9587dbd4de36d4c8ecf2fd7b5eef9e1dfb2cd"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-378379930562.us-central1.cloudfunctions.appspot.com/9f488130-e9bb-4bc1-b6ac-f7f93a2b68c6.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"pixelynth-c41ea\",\"storageBucket\":\"pixelynth-c41ea.firebasestorage.app\"}","GCLOUD_PROJECT":"pixelynth-c41ea","EVENTARC_CLOUD_EVENT_SOURCE":"projects/pixelynth-c41ea/locations/us-central1/functions/syncDeletePostToMyImages"},"runtime":"nodejs18","maxInstances":3000,"ingressSettings":"ALLOW_ALL","buildId":"d6fe116b-02ab-402d-865d-a467c9e32b7c","buildEnvironmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"buildName":"projects/706633323779/locations/us-central1/builds/d6fe116b-02ab-402d-865d-a467c9e32b7c","dockerRegistry":"ARTIFACT_REGISTRY","automaticUpdatePolicy":{},"buildServiceAccount":"projects/pixelynth-c41ea/serviceAccounts/706633323779-compute@developer.gserviceaccount.com"},{"name":"projects/pixelynth-c41ea/locations/us-central1/functions/syncImageUpdate","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.update","resource":"projects/pixelynth-c41ea/databases/(default)/documents/post/{imageId}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"syncImageUpdate","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"pixelynth-c41ea@appspot.gserviceaccount.com","updateTime":"2025-03-20T05:22:28.088570562Z","versionId":"1","labels":{"deployment-tool":"cli-firebase","firebase-functions-hash":"749913253e557e55cf60042929f0fa46828a9dcc"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-378379930562.us-central1.cloudfunctions.appspot.com/efad332c-b59e-4f2e-9a19-7e30407a42d7.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"pixelynth-c41ea\",\"storageBucket\":\"pixelynth-c41ea.firebasestorage.app\"}","GCLOUD_PROJECT":"pixelynth-c41ea","EVENTARC_CLOUD_EVENT_SOURCE":"projects/pixelynth-c41ea/locations/us-central1/functions/syncImageUpdate"},"runtime":"nodejs18","maxInstances":3000,"ingressSettings":"ALLOW_ALL","buildId":"5e473b78-fc35-42c1-84c9-70285c9c8574","buildEnvironmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"buildName":"projects/706633323779/locations/us-central1/builds/5e473b78-fc35-42c1-84c9-70285c9c8574","dockerRegistry":"ARTIFACT_REGISTRY","automaticUpdatePolicy":{},"buildServiceAccount":"projects/pixelynth-c41ea/serviceAccounts/706633323779-compute@developer.gserviceaccount.com"},{"name":"projects/pixelynth-c41ea/locations/us-central1/functions/fetchImage","httpsTrigger":{"url":"https://us-central1-pixelynth-c41ea.cloudfunctions.net/fetchImage","securityLevel":"SECURE_ALWAYS"},"status":"ACTIVE","entryPoint":"fetchImage","timeout":"300s","availableMemoryMb":1024,"serviceAccountEmail":"pixelynth-c41ea@appspot.gserviceaccount.com","updateTime":"2025-02-16T16:07:42.422Z","versionId":"2","labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"b0663e02234700c161b50e1e4c0a7ba52b066bd7"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-378379930562.us-central1.cloudfunctions.appspot.com/ba1d56e9-b7af-4353-a161-f2d1c362d7fb.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"pixelynth-c41ea\",\"storageBucket\":\"pixelynth-c41ea.firebasestorage.app\"}","GCLOUD_PROJECT":"pixelynth-c41ea","EVENTARC_CLOUD_EVENT_SOURCE":"projects/pixelynth-c41ea/locations/us-central1/functions/fetchImage"},"runtime":"nodejs18","maxInstances":10,"ingressSettings":"ALLOW_ALL","buildId":"5c8d98ba-cc20-4ac2-8535-4ce3bba7e8f7","buildEnvironmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"buildName":"projects/706633323779/locations/us-central1/builds/5c8d98ba-cc20-4ac2-8535-4ce3bba7e8f7","dockerRegistry":"ARTIFACT_REGISTRY","automaticUpdatePolicy":{},"buildServiceAccount":"projects/pixelynth-c41ea/serviceAccounts/706633323779-compute@developer.gserviceaccount.com"}]}
[debug] [2025-03-22T04:44:59.127Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:59.128Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:44:59.128Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/pixelynth-c41ea/locations/-/functions filter=environment%3D%22GEN_2%22
[debug] [2025-03-22T04:45:00.587Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/pixelynth-c41ea/locations/-/functions 200
[debug] [2025-03-22T04:45:00.587Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/pixelynth-c41ea/locations/-/functions {}
[debug] [2025-03-22T04:45:00.594Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:45:00.594Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:45:00.594Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v1/projects/pixelynth-c41ea/locations/us-central1/functions:generateUploadUrl [none]
[debug] [2025-03-22T04:45:00.594Z] >>> [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/pixelynth-c41ea/locations/us-central1/functions:generateUploadUrl {}
[debug] [2025-03-22T04:45:02.205Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v1/projects/pixelynth-c41ea/locations/us-central1/functions:generateUploadUrl 200
[debug] [2025-03-22T04:45:02.205Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/pixelynth-c41ea/locations/us-central1/functions:generateUploadUrl {"uploadUrl":"https://storage.googleapis.com/uploads-378379930562.us-central1.cloudfunctions.appspot.com/1b3e6688-3fcf-4d7f-a18e-52b4769e8659.zip?GoogleAccessId=service-706633323779@gcf-admin-robot.iam.gserviceaccount.com&Expires=1742620501&Signature=D7UMn6Gf8e%2FwC0radgN2rM4AFJPyhe7NZGdJ11kDyDw2mrudvtoO9A4CFRE5ucdhHaCwHdEPcgp%2BmlVqVwgLqd%2Fn5u0LJc8XSpCT4QOdzPg1K%2FpgoSyGcpDXcV6sIZv8MpHzfbibGpEktJyrjxMWweATMoZdeNxIw5Wp6ZNjqOixRcOrWS9mQkR7HzZ7oJ%2BDMZVQwFcSwvn%2FPcjQi9v8jqVELBVe27rVrEi983A%2BTyqmQ7ZzdBNxro3GAQMx64CjnGcQBbsbLt5LFoqFa%2Bd5HdmVMWpL1jR8s6XllyxgAZkSl6VNH%2FFAHygf4YwSFSsZ141I5soAUPCVQaNoISXCMw%3D%3D"}
[debug] [2025-03-22T04:45:02.206Z] >>> [apiv2][query] PUT https://storage.googleapis.com/uploads-378379930562.us-central1.cloudfunctions.appspot.com/1b3e6688-3fcf-4d7f-a18e-52b4769e8659.zip GoogleAccessId=service-706633323779%40gcf-admin-robot.iam.gserviceaccount.com&Expires=1742620501&Signature=D7UMn6Gf8e%2FwC0radgN2rM4AFJPyhe7NZGdJ11kDyDw2mrudvtoO9A4CFRE5ucdhHaCwHdEPcgp%2BmlVqVwgLqd%2Fn5u0LJc8XSpCT4QOdzPg1K%2FpgoSyGcpDXcV6sIZv8MpHzfbibGpEktJyrjxMWweATMoZdeNxIw5Wp6ZNjqOixRcOrWS9mQkR7HzZ7oJ%2BDMZVQwFcSwvn%2FPcjQi9v8jqVELBVe27rVrEi983A%2BTyqmQ7ZzdBNxro3GAQMx64CjnGcQBbsbLt5LFoqFa%2Bd5HdmVMWpL1jR8s6XllyxgAZkSl6VNH%2FFAHygf4YwSFSsZ141I5soAUPCVQaNoISXCMw%3D%3D
[debug] [2025-03-22T04:45:02.206Z] >>> [apiv2][body] PUT https://storage.googleapis.com/uploads-378379930562.us-central1.cloudfunctions.appspot.com/1b3e6688-3fcf-4d7f-a18e-52b4769e8659.zip [stream]
[debug] [2025-03-22T04:45:03.108Z] <<< [apiv2][status] PUT https://storage.googleapis.com/uploads-378379930562.us-central1.cloudfunctions.appspot.com/1b3e6688-3fcf-4d7f-a18e-52b4769e8659.zip 200
[debug] [2025-03-22T04:45:03.108Z] <<< [apiv2][body] PUT https://storage.googleapis.com/uploads-378379930562.us-central1.cloudfunctions.appspot.com/1b3e6688-3fcf-4d7f-a18e-52b4769e8659.zip [omitted]
[info] ✔  functions: functions folder uploaded successfully 
[debug] [2025-03-22T04:45:03.113Z] Total Function Deployment time: 0
[debug] [2025-03-22T04:45:03.113Z] 0 Functions Deployed
[debug] [2025-03-22T04:45:03.113Z] 0 Functions Errored
[debug] [2025-03-22T04:45:03.113Z] 0 Function Deployments Aborted
[debug] [2025-03-22T04:45:03.113Z] Average Function Deployment time: NaN
[info] i  functions: cleaning up build files... 
[debug] [2025-03-22T04:45:03.288Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:45:03.288Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:45:03.288Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:45:03.288Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:45:03.288Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:45:03.288Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:45:03.288Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:45:03.288Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:45:03.288Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/pixelynth-c41ea/locations/us-central1/repositories/gcf-artifacts/packages/sync_post_to_my_images [none]
[debug] [2025-03-22T04:45:03.290Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/pixelynth-c41ea/locations/us-central1/repositories/gcf-artifacts/packages/sync_delete_post_to_my_images [none]
[debug] [2025-03-22T04:45:03.290Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/pixelynth-c41ea/locations/us-central1/repositories/gcf-artifacts/packages/sync_delete_my_images_to_post [none]
[debug] [2025-03-22T04:45:03.291Z] >>> [apiv2][query] GET https://us.gcr.io/v2/pixelynth-c41ea/gcf/us-central1/tags/list [none]
[debug] [2025-03-22T04:45:03.894Z] <<< [apiv2][status] GET https://us.gcr.io/v2/pixelynth-c41ea/gcf/us-central1/tags/list 404
[debug] [2025-03-22T04:45:03.894Z] <<< [apiv2][body] GET https://us.gcr.io/v2/pixelynth-c41ea/gcf/us-central1/tags/list {"errors":[{"code":"NAME_UNKNOWN","message":"Repository \"us.gcr.io\" not found"}]}
[debug] [2025-03-22T04:45:03.895Z] Failed docker command with error  Request to https://us.gcr.io/v2/pixelynth-c41ea/gcf/us-central1/tags/list had HTTP Error: 404, Not Found {"name":"FirebaseError","children":[],"context":{"body":{"errors":[{"code":"NAME_UNKNOWN","message":"Repository \"us.gcr.io\" not found"}],"error":{"message":"Not Found"}},"response":{"statusCode":404}},"exit":1,"message":"Request to https://us.gcr.io/v2/pixelynth-c41ea/gcf/us-central1/tags/list had HTTP Error: 404, Not Found","status":404}
[debug] [2025-03-22T04:45:03.897Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:45:03.897Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:45:03.897Z] >>> [apiv2][query] GET https://us.gcr.io/v2/pixelynth-c41ea/gcf/us-central1/tags/list [none]
[debug] [2025-03-22T04:45:04.446Z] <<< [apiv2][status] GET https://us.gcr.io/v2/pixelynth-c41ea/gcf/us-central1/tags/list 404
[debug] [2025-03-22T04:45:04.446Z] <<< [apiv2][body] GET https://us.gcr.io/v2/pixelynth-c41ea/gcf/us-central1/tags/list {"errors":[{"code":"NAME_UNKNOWN","message":"Repository \"us.gcr.io\" not found"}]}
[debug] [2025-03-22T04:45:04.446Z] Failed docker command with error  Request to https://us.gcr.io/v2/pixelynth-c41ea/gcf/us-central1/tags/list had HTTP Error: 404, Not Found {"name":"FirebaseError","children":[],"context":{"body":{"errors":[{"code":"NAME_UNKNOWN","message":"Repository \"us.gcr.io\" not found"}],"error":{"message":"Not Found"}},"response":{"statusCode":404}},"exit":1,"message":"Request to https://us.gcr.io/v2/pixelynth-c41ea/gcf/us-central1/tags/list had HTTP Error: 404, Not Found","status":404}
[debug] [2025-03-22T04:45:04.456Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/pixelynth-c41ea/locations/us-central1/repositories/gcf-artifacts/packages/sync_delete_post_to_my_images 404
[debug] [2025-03-22T04:45:04.456Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/pixelynth-c41ea/locations/us-central1/repositories/gcf-artifacts/packages/sync_delete_post_to_my_images {"error":{"code":404,"message":"Package \"projects/pixelynth-c41ea/locations/us-central1/repositories/gcf-artifacts/packages/sync_delete_post_to_my_images\" was not found.","status":"NOT_FOUND"}}
[debug] [2025-03-22T04:45:04.473Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/pixelynth-c41ea/locations/us-central1/repositories/gcf-artifacts/packages/sync_post_to_my_images 404
[debug] [2025-03-22T04:45:04.474Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/pixelynth-c41ea/locations/us-central1/repositories/gcf-artifacts/packages/sync_post_to_my_images {"error":{"code":404,"message":"Package \"projects/pixelynth-c41ea/locations/us-central1/repositories/gcf-artifacts/packages/sync_post_to_my_images\" was not found.","status":"NOT_FOUND"}}
[debug] [2025-03-22T04:45:04.479Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/pixelynth-c41ea/locations/us-central1/repositories/gcf-artifacts/packages/sync_delete_my_images_to_post 404
[debug] [2025-03-22T04:45:04.479Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/pixelynth-c41ea/locations/us-central1/repositories/gcf-artifacts/packages/sync_delete_my_images_to_post {"error":{"code":404,"message":"Package \"projects/pixelynth-c41ea/locations/us-central1/repositories/gcf-artifacts/packages/sync_delete_my_images_to_post\" was not found.","status":"NOT_FOUND"}}
[debug] [2025-03-22T04:45:04.548Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:45:04.549Z] Checked if tokens are valid: true, expires at: 1742619613169
[debug] [2025-03-22T04:45:04.549Z] >>> [apiv2][query] GET https://us.gcr.io/v2/pixelynth-c41ea/gcf/us-central1/tags/list [none]
[debug] [2025-03-22T04:45:05.063Z] <<< [apiv2][status] GET https://us.gcr.io/v2/pixelynth-c41ea/gcf/us-central1/tags/list 404
[debug] [2025-03-22T04:45:05.063Z] <<< [apiv2][body] GET https://us.gcr.io/v2/pixelynth-c41ea/gcf/us-central1/tags/list {"errors":[{"code":"NAME_UNKNOWN","message":"Repository \"us.gcr.io\" not found"}]}
[debug] [2025-03-22T04:45:05.063Z] Failed docker command with error  Request to https://us.gcr.io/v2/pixelynth-c41ea/gcf/us-central1/tags/list had HTTP Error: 404, Not Found {"name":"FirebaseError","children":[],"context":{"body":{"errors":[{"code":"NAME_UNKNOWN","message":"Repository \"us.gcr.io\" not found"}],"error":{"message":"Not Found"}},"response":{"statusCode":404}},"exit":1,"message":"Request to https://us.gcr.io/v2/pixelynth-c41ea/gcf/us-central1/tags/list had HTTP Error: 404, Not Found","status":404}
[warn] ⚠  functions: Unhandled error cleaning up build images. This could result in a small monthly bill if not corrected. You can attempt to delete these images by redeploying or you can delete them manually at https://console.cloud.google.com/gcr/images/pixelynth-c41ea/us/gcf 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/pixelynth-c41ea/overview
